CREATE DATABASE SALES_MANAGEMENT
GO

USE SALES_MANAGEMENT
GO

CREATE TABLE NHANVIEN
(
	MANV VARCHAR(20) NOT NULL,
	PASSWORD VARCHAR(100) NOT NULL,
	TEN NVARCHAR(50),
	NGAYSINH SMALLDATETIME,
	GIOITINH NVARCHAR(10),
	SDT VARCHAR(20),
	DIACHI NVARCHAR(100),
	CONSTRAINT PK_NHANVIEN PRIMARY KEY (MANV)
)
GO

CREATE TABLE QUANLY
(
	MAQL VARCHAR(20) NOT NULL,
	PASSWORD VARCHAR(100) NOT NULL,
	TEN NVARCHAR(50),
	NGAYSINH SMALLDATETIME,
	GIOITINH NVARCHAR(10),
	SDT VARCHAR(20),
	DIACHI NVARCHAR(100),
	CONSTRAINT PK_QUANLY PRIMARY KEY (MAQL),
)
GO

CREATE TABLE KHACHHANG
(
	MAKH VARCHAR(20) NOT NULL,
	TEN NVARCHAR(50),
	NGAYSINH SMALLDATETIME,
	GIOITINH NVARCHAR(10),
	SDT VARCHAR(20),
	DIACHI NVARCHAR(100),
	DIEM INT,
	CONSTRAINT PK_KHACHHANG PRIMARY KEY (MAKH),
)
GO

CREATE TABLE SANPHAM
(
	MASP VARCHAR(20) NOT NULL,
	TEN NVARCHAR(100),
	SOLUONG INT,
	DVT NVARCHAR(50),
	GIANHAP INT,
	GIABANLE INT,
	HSD SMALLDATETIME,
	NHACUNGCAP NVARCHAR(100),
	GHICHU NVARCHAR(100),
	CONSTRAINT PK_SANPHAM PRIMARY KEY (MASP)
)
GO

CREATE TABLE HOADON
(
	MAHD VARCHAR(20) NOT NULL,
	MANV VARCHAR(20) NOT NULL,
	MAKH VARCHAR(20),
	THOIGIAN SMALLDATETIME,
	STATUS INT NOT NULL DEFAULT 0, -- 0: Chưa thanh toán -- 1: Đã thanh toán
	CONSTRAINT PK_HOADON PRIMARY KEY (MAHD)
)
GO

CREATE TABLE CTHD
(
	MAHD VARCHAR(20) NOT NULL,
	MASP VARCHAR(20) NOT NULL,
	DONGIA INT,
	SOLUONG INT,
	CONSTRAINT PK_CTHD PRIMARY KEY (MAHD, MASP)
)
GO

ALTER TABLE HOADON
ADD CONSTRAINT FK_HOADON_NHANVIEN_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
GO

ALTER TABLE HOADON
ADD CONSTRAINT FK_HOADON_KHACHHANG_MAKH FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)
GO

ALTER TABLE CTHD
ADD CONSTRAINT FK_CTHD_HOADON_MAHD FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD)
GO

ALTER TABLE CTHD
ADD CONSTRAINT FK_CTHD_SANPHAM_MASP FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP)
GO

ALTER TABLE SANPHAM
ADD GHICHU NVARCHAR(100)

ALTER TABLE NHANVIEN
ALTER COLUMN TEN NVARCHAR(50)
ALTER TABLE QUANLY
ALTER COLUMN TEN NVARCHAR(50)
ALTER TABLE KHACHHANG
ALTER COLUMN TEN NVARCHAR(50)
ALTER TABLE SANPHAM
ALTER COLUMN TEN NVARCHAR(50)

ALTER TABLE NHANVIEN
ALTER COLUMN DIACHI NVARCHAR(100)
ALTER TABLE QUANLY
ALTER COLUMN DIACHI NVARCHAR(100)
ALTER TABLE KHACHHANG
ALTER COLUMN DIACHI NVARCHAR(100)

ALTER TABLE NHANVIEN
ALTER COLUMN GIOITINH NVARCHAR(10)
ALTER TABLE QUANLY
ALTER COLUMN GIOITINH NVARCHAR(10)
ALTER TABLE KHACHHANG
ALTER COLUMN GIOITINH NVARCHAR(10)

ALTER TABLE SANPHAM
ALTER COLUMN NHACUNGCAP NVARCHAR(100)
ALTER TABLE SANPHAM
ALTER COLUMN DVT NVARCHAR(50)

set dateformat dmy
-- SANPHAM
INSERT INTO SANPHAM VALUES ('3694362852260','Coca Cola 330ml',43,'Lon',8000,10000,'25/08/2021','Coca-Cola','')
INSERT INTO SANPHAM VALUES ('6175747286674','7Up 330ml/Lon',48,'Lon',8000,10000,'12/05/2021','Pepsi','')
INSERT INTO SANPHAM VALUES ('8738772500405','Pepsi 330ml/Lon',46,'Lon',8000,10000,'09/06/2021','Pepsi','')
INSERT INTO SANPHAM VALUES ('9709955748951','Bánh Chocopie',12,'Hộp',43000,48000,'14/07/2021','Orion Vina','')
INSERT INTO SANPHAM VALUES ('7903887909141','Mỳ Hảo Hảo Tôm chua cay',36,'Gói',2500,3000,'03/05/2021','ACECOOK','')
INSERT INTO SANPHAM VALUES ('9303914296905','Mỳ Omachi Xốt bò hầm',28,'Gói',5500,6000,'17/08/2021','Masan','')
INSERT INTO SANPHAM VALUES ('6429981858495','Bánh AFC Vị lúa mì 200g',6,'Hộp',24000,27000,'22/05/2021','Kinh Đô','')
INSERT INTO SANPHAM VALUES ('9798371282668','Sữa Milo 180ml',32,'Hộp',6000,7000,'18/05/2021','MILO','')
INSERT INTO SANPHAM VALUES ('7795105401069','Cà phê NESCAFE ESPRESSODA 330ml',14,'Lon',10000,12000,'27/07/2021','NESCAFE','')
INSERT INTO SANPHAM VALUES ('3925444825477','Sữa đậu nành Fami 200ml',24,'Bịch',3500,4000,'29/03/2021','Vinasoy','')

-- NHANVIEN
INSERT INTO NHANVIEN VALUES ('NV001','161217381747022820119720656236237850238247','Nguyễn Văn An','01/01/2001','Nam','0935735816','Thủ Đức, TPHCM')
INSERT INTO NHANVIEN VALUES ('NV002','2282422021244143248137221361901441482301237','Trần Trung Hiếu','10/10/2000','Nam','0914758372','Bình Thạnh, TPHCM')
INSERT INTO NHANVIEN VALUES ('NV003','36861675317221110947128204921723013142242','Trần Như Phương','21/08/1998','Nữ','0924587183','Dĩ An, Bình Dương')

-- QUANLY
INSERT INTO QUANLY VALUES ('QL001','13541541422814327128216551122161791976217','Vũ Minh Lộc','16/03/1992','Nam','0912517683','Thủ Đức, TPHCM')

-- KHACHHANG
INSERT INTO KHACHHANG VALUES ('KH001','Trần Thanh','01/01/1990','Nam','0915387624','Thủ Đức, TPHCM',145)
INSERT INTO KHACHHANG VALUES ('KH002','Lê Trung Hậu','05/04/1983','Nam','0925743651','Bình Thạnh, TPHCM',82)
INSERT INTO KHACHHANG VALUES ('KH003','Nguyễn Thu Trang','25/07/1997','Nữ','0913582486','Dĩ An, Bình Dương',117)